<%!
  from routes.util import url_for
  from r2.lib.filters import safemarkdown
  from r2.lib.utils import prettytime, epochtime
  from r2.lib.template_helpers import static
%>
<% meetup = thing.meetup %>
<h1>
  <a href="${url_for(controller='meetups', action='show', id=meetup._id36)}">${meetup.title}</a>
</h1>
<div id="" class="content clear">
  ${unsafe(safemarkdown(meetup.description))}
</div><!-- .content -->
<div class="meetup meta clear">
  <strong>When:</strong>&#32;
  <span class="date">${prettytime(meetup.datetime())}</span><br>

  <strong>Where:</strong>&#32;
  <span class="address">${meetup.location}</span>
</div><!-- .meta -->
<div id="map" data-latitude="${meetup.latitude}" data-longitude="${meetup.longitude}" data-title="${meetup.location}"></div>

%if meetup.can_edit(c.user, c.user_is_admin):
  <a href="${url_for(controller='meetups', action='edit', id=meetup._id36)}">${_('Edit meetup')}</a>
%endif

<!-- NOTE: These divs are here to make the comment.js code work with a new
     top level comment.  These are copied from link.html.  I don't know
     why they are required!
-->
<div id="thingrow_${thing.fullname}" class="post">
  <div id="entry_${thing.fullname}" class="content clear"></div>
</div>

<div style="display: none;" id='lastViewed' time="${ epochtime(thing.lastViewed if thing.lastViewed else None) }"></div>

<div class="meetup-comments">
  ${thing.content.render()}
</div>

<script src="${static('meetups.js')}" type="text/javascript" charset="utf-8"></script>
